# Лабораторна робота №5: Розробка RESTful API

## Інформація про проєкт
- **Назва проєкту:** Магазин курсів по мовам програмування
- **Автори:** Шавирін Ярослав Олексійович (Головний)
- **Дата виконання:** 25.11.2025
- **Статус:** ✅ Production Ready

---

## Опис проєкту

У моєму магазині можна замовляти книжки по різним курсам з мов програмування.

### Основні можливості:
- ✅ Управління каталогом товарів (CRUD операції)
- ✅ Обробка замовлень та їх статусів
- ✅ Система відгуків/рецензій
- ✅ Управління клієнтами з базою даних
- ✅ Кошик покупок та оформлення замовлень
- ✅ Адміністративна панель з аутентифікацією
- ✅ Швидкий пошук та фільтрація товарів
- ✅ Валідація вхідних даних та обробка помилок

---

## Технології

- **Python 3.x** — мова програмування
- **Flask** — веб-фреймворк для побудови API та веб-додатків
- **SQLite** — легка база даних для зберігання даних
- **Flasgger** — автоматична генерація Swagger/OpenAPI документації
- **Jinja2** — шаблонізатор для HTML-сторінок

---

## Endpoints API

### Base URL: `http://127.0.0.1:5000/api/v1`

---

### 1. Health Check

#### **GET /health**
- **URL:** `/api/v1/health`
- **Метод:** `GET`
- **Опис:** Перевірити стан API та переконатися, що сервер працює

**Приклад запиту:**
```bash
GET http://127.0.0.1:5000/api/v1/health
```

**Приклад відповіді:**
```json
{
  "status": "success",
  "status_code": 200,
  "data": {
    "status": "API is running"
  }
}
```

---

### 2. Управління товарами (Products)

#### **GET /products**
- **URL:** `/api/v1/products`
- **Метод:** `GET`
- **Опис:** Отримати всі товари з опціональною фільтрацією та пошуком
- **Параметри:**
  - `q` (опціонально) - пошук за назвою товару
  - `min_price` (опціонально) - мінімальна ціна
  - `max_price` (опціонально) - максимальна ціна
  - `has_image` (опціонально) - true/false (тільки товари з фото)

**Приклади запитів:**
```bash
# Отримати всі товари
GET http://127.0.0.1:5000/api/v1/products

# Пошук за назвою
GET http://127.0.0.1:5000/api/v1/products?q=книга

# Фільтрація за ціною
GET http://127.0.0.1:5000/api/v1/products?min_price=100&max_price=500

# Тільки товари з фото
GET http://127.0.0.1:5000/api/v1/products?has_image=true
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": [
    {
      "id": 1,
      "name": "Книга",
      "price": 150.00,
      "image": "https://example.com/book.jpg"
    },
    {
      "id": 2,
      "name": "Ручка",
      "price": 25.00,
      "image": "https://example.com/pen.jpg"
    }
  ]
}
```

---

### 3. Управління замовленнями (Orders)

#### **GET /orders**
- **URL:** `/api/v1/orders`
- **Метод:** `GET`
- **Опис:** Отримати всі замовлення або замовлення за email
- **Параметри:**
  - `email` (опціонально) - фільтрація замовлень за email користувача

**Приклад запиту:**
```bash
# Отримати всі замовлення
GET http://127.0.0.1:5000/api/v1/orders

# Замовлення конкретного користувача
GET http://127.0.0.1:5000/api/v1/orders?email=user@example.com
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": [
    {
      "id": 1,
      "email": "user@example.com",
      "address": "вул. Шевченка, 10",
      "phone": "+380123456789",
      "total_price": 300.00,
      "status": "Нове",
      "date": "2024-01-15 14:30:00"
    }
  ]
}
```

---

#### **GET /orders/{id}**
- **URL:** `/api/v1/orders/{id}`
- **Метод:** `GET`
- **Опис:** Отримати детальну інформацію про замовлення з усіма позиціями товарів

**Приклад запиту:**
```bash
GET http://127.0.0.1:5000/api/v1/orders/1
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": {
    "order": {
      "id": 1,
      "email": "user@example.com",
      "address": "вул. Шевченка, 10",
      "phone": "+380123456789",
      "total_price": 300.00,
      "status": "Нове",
      "date": "2024-01-15 14:30:00"
    },
    "items": [
      {
        "quantity": 2,
        "name": "Книга",
        "price": 150.00
      }
    ]
  }
}
```

---

#### **POST /orders**
- **URL:** `/api/v1/orders`
- **Метод:** `POST`
- **Опис:** Створити нове замовлення
- **Обов'язкові поля:** `email`, `address`, `cart`

**Приклад запиту:**
```json
{
  "email": "test@example.com",
  "address": "вул. Тестова, 1",
  "phone": "+380123456789",
  "cart": {
    "1": {
      "id": 1,
      "name": "Товар",
      "price": 100,
      "quantity": 2
    }
  }
}
```

**Приклад відповіді (201 Created):**
```json
{
  "status": "success",
  "status_code": 201,
  "data": {
    "order_id": 5,
    "message": "Order created successfully"
  }
}
```

---

#### **PUT /orders/{id}**
- **URL:** `/api/v1/orders/{id}`
- **Метод:** `PUT`
- **Опис:** Оновити статус замовлення
- **Обов'язкові поля:** `status`

**Приклад запиту:**
```json
{
  "status": "Обробляється"
}
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": {
    "message": "Order updated successfully"
  }
}
```

---

#### **DELETE /orders/{id}**
- **URL:** `/api/v1/orders/{id}`
- **Метод:** `DELETE`
- **Опис:** Видалити замовлення з системи

**Приклад запиту:**
```bash
DELETE http://127.0.0.1:5000/api/v1/orders/1
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": {
    "message": "Order deleted successfully"
  }
}
```

---

### 4. Управління відгуками (Feedback)

#### **GET /feedback**
- **URL:** `/api/v1/feedback`
- **Метод:** `GET`
- **Опис:** Отримати всі відгуки

**Приклад запиту:**
```bash
GET http://127.0.0.1:5000/api/v1/feedback
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": [
    {
      "id": 1,
      "name": "Іван Петренко",
      "email": "ivan@example.com",
      "message": "Чудовий товар!"
    }
  ]
}
```

---

#### **POST /feedback**
- **URL:** `/api/v1/feedback`
- **Метод:** `POST`
- **Опис:** Створити новий відгук
- **Обов'язкові поля:** `name`, `email`, `message`

**Приклад запиту:**
```json
{
  "name": "Іван Петренко",
  "email": "ivan@example.com",
  "message": "Чудовий товар! Дуже задоволений"
}
```

**Приклад відповіді (201 Created):**
```json
{
  "status": "success",
  "status_code": 201,
  "data": {
    "feedback_id": 5,
    "message": "Feedback submitted successfully"
  }
}
```

---

#### **DELETE /feedback/{id}**
- **URL:** `/api/v1/feedback/{id}`
- **Метод:** `DELETE`
- **Опис:** Видалити відгук з системи

**Приклад запиту:**
```bash
DELETE http://127.0.0.1:5000/api/v1/feedback/1
```

**Приклад відповіді (200 OK):**
```json
{
  "status": "success",
  "status_code": 200,
  "data": {
    "deleted_id": 1,
    "message": "Feedback deleted successfully"
  }
}
```
## Результати скріншоти:
photos/image.deletefeed.webp
photos/image.deleteorders.webp
photos/image.getfeed.webp
photos/image.gethealth.webp
photos/image.getorderid.webp
photos/image.getorders.webp
photos/image.getproducts.webp
photos/image.postfeed.webp
photos/image.postorders.webp
photos/image.putorderid.webp
---

## Результати тестування в Postman (або Swagger)

### Тестовий сценарій 1: Health Check
- **Мета:** Перевірити базову функціональність API та переконатися, що сервер запущений
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** API працює коректно

---

### Тестовий сценарій 2: Отримання всіх товарів
- **Мета:** Перевірити отримання списку товарів
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Повернено список усіх товарів з коректною структурою

---

### Тестовий сценарій 3: Пошук товарів за назвою
- **Мета:** Перевірити фільтрацію товарів за пошуковим терміном
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Повернено товари, що містять пошуковий термін в назві

---

### Тестовий сценарій 4: Фільтрація товарів за ціною
- **Мета:** Перевірити фільтрацію товарів за цінойими діапазонам
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Повернено товари в указаному діапазоні ціни

---

### Тестовий сценарій 5: Отримання всіх замовлень
- **Мета:** Перевірити отримання списку замовлень
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Повернено список всіх замовлень

---

### Тестовий сценарій 6: Отримання замовлення за ID
- **Мета:** Перевірити отримання детальної інформації про конкретне замовлення
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Повернена інформація про замовлення та всі його позиції товарів

---

### Тестовий сценарій 7: Створення нового замовлення
- **Мета:** Перевірити оформлення нового замовлення з коректними даними
- **Результат:** ✅ Успішно
- **HTTP Status:** 201 Created
- **Опис:** Замовлення успішно створено в системі

---

### Тестовий сценарій 8: Валідація обов'язкових полів при створенні замовлення
- **Мета:** Перевірити обробку помилки при відсутності обов'язкового поля (email)
- **Результат:** ✅ Успішно
- **HTTP Status:** 400 Bad Request
- **Опис:** Система коректно повернула помилку про відсутнє поле

---

### Тестовий сценарій 9: Оновлення статусу замовлення
- **Мета:** Перевірити оновлення статусу замовлення
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Статус замовлення успішно оновлено

---

### Тестовий сценарій 10: Видалення замовлення
- **Мета:** Перевірити видалення замовлення з системи
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Замовлення успішно видалено

---

### Тестовий сценарій 11: Створення нового відгуку
- **Мета:** Перевірити додавання нового відгуку
- **Результат:** ✅ Успішно
- **HTTP Status:** 201 Created
- **Опис:** Відгук успішно створено в системі

---

### Тестовий сценарій 12: Обробка невірного Content-Type
- **Мета:** Перевірити валідацію Content-Type при отриманні запиту
- **Результат:** ✅ Успішно
- **HTTP Status:** 400 Bad Request
- **Опис:** Система коректно повернула помилку про невірний Content-Type

---

### Тестовий сценарій 13: Видалення відгуку
- **Мета:** Перевірити видалення існуючого відгуку
- **Результат:** ✅ Успішно
- **HTTP Status:** 200 OK
- **Опис:** Відгук успішно видалено

---

### Тестовий сценарій 14: Видалення неіснуючого відгуку
- **Мета:** Перевірити обробку помилки при видаленні неіснуючого відгуку
- **Результат:** ✅ Успішно
- **HTTP Status:** 404 Not Found
- **Опис:** Система коректно повернула помилку про те, що ресурс не знайдено

---

Скріншоти результатів:

---

## Обробка помилок

Список реалізованих кодів помилок:

### **400 Bad Request** — Помилки валідації
- **Коли виникає:** Відсутні обов'язкові поля, невірний формат JSON, невірний Content-Type
- **Приклад:**
```json
{
  "error": "Missing required field: email",
  "code": "MISSING_FIELD",
  "status": 400,
  "field": "email"
}
```

### **404 Not Found** — Ресурс не знайдено
- **Коли виникає:** Товар, замовлення або відгук з указаним ID не існує
- **Приклад:**
```json
{
  "error": "Product not found",
  "code": "PRODUCT_NOT_FOUND",
  "status": 404
}
```

### **500 Internal Server Error** — Помилка сервера
- **Коли виникає:** Помилка при роботі з базою даних або непередбачена помилка при обробці запиту
- **Приклад:**
```json
{
  "error": "Error retrieving products: database error",
  "code": "PRODUCT_RETRIEVAL_ERROR",
  "status": 500
}
```
